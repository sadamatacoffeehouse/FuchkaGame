<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fuchka Master</title>

<style>
body{
  margin:0;
  overflow:hidden;
  font-family:sans-serif;
  background:url('images/logo.png') no-repeat center center fixed;
  background-size:cover;
}

/* Overlay for slight dim effect */
body::after{
  content:"";
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(255,233,198,0.85);
  z-index:-1;
}

#scoreBoard{
  position:absolute;
  top:10px;
  left:10px;
  font-size:18px;
  font-weight:bold;
}

#plate{
  width:200px;
  height:30px;
  background:#5c2e00;
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  border-radius:20px;
}

.item{
  width:40px;
  height:40px;
  position:absolute;
  top:0;
  background-size:cover;
  background-position:center;
}

#collected{
  position:absolute;
  bottom:55px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:5px;
}

.collected-item{
  width:30px;
  height:30px;
  background-size:cover;
}

#gameOver{
  position:absolute;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.8);
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  font-size:24px;
  display:none;
}

button{
  padding:10px 20px;
  font-size:18px;
  margin-top:15px;
}
</style>
</head>

<body>

<div id="scoreBoard">Score: 0 | Life: 3 | High: 0</div>
<div id="collected"></div>
<div id="plate"></div>

<div id="gameOver">
  <div id="finalText"></div>
  <button onclick="restartGame()">Restart</button>
</div>

<script>

let plate = document.getElementById("plate");
let scoreBoard = document.getElementById("scoreBoard");
let collected = document.getElementById("collected");
let gameOverScreen = document.getElementById("gameOver");
let finalText = document.getElementById("finalText");

let score = 0;
let life = 3;
let highScore = localStorage.getItem("highScore") || 0;
let speed = 4;
let gameRunning = true;

updateBoard();

document.addEventListener("mousemove", movePlate);
document.addEventListener("touchmove", function(e){
  movePlate(e.touches[0]);
});

function movePlate(e){
  plate.style.left = e.clientX - 100 + "px";
  collected.style.left = e.clientX - 100 + "px";
}

function createItem(){
  if(!gameRunning) return;

  let item = document.createElement("div");
  item.classList.add("item");

  let rand = Math.random();

  if(rand < 0.7){
    item.style.backgroundImage = "url('images/fuchka.png')";
    item.dataset.type = "normal";
  }
  else if(rand < 0.9){
    item.style.backgroundImage = "url('images/spicy.png')";
    item.dataset.type = "spicy";
  }
  else{
    item.style.backgroundImage = "url('images/bomb.png')";
    item.dataset.type = "bomb";
  }

  item.style.left = Math.random() * (window.innerWidth - 40) + "px";
  document.body.appendChild(item);

  let fall = setInterval(function(){

    if(!gameRunning){
      clearInterval(fall);
      return;
    }

    item.style.top = item.offsetTop + speed + "px";

    if(item.offsetTop > window.innerHeight){
      if(item.dataset.type !== "bomb"){
        life--;
      }
      item.remove();
      clearInterval(fall);
      checkGameOver();
      updateBoard();
    }

    if(
      item.offsetTop > window.innerHeight - 90 &&
      item.offsetLeft > plate.offsetLeft &&
      item.offsetLeft < plate.offsetLeft + 200
    ){

      if(item.dataset.type === "normal"){
        score += 1;
        addToPlate("images/fuchka.png");
      }
      else if(item.dataset.type === "spicy"){
        score += 3;
        speed += 0.5;
        addToPlate("images/spicy.png");
      }
      else if(item.dataset.type === "bomb"){
        life = 0;
      }

      item.remove();
      clearInterval(fall);
      updateBoard();
      checkGameOver();
    }

  },20);
}

function addToPlate(imagePath){
  let small = document.createElement("div");
  small.classList.add("collected-item");
  small.style.backgroundImage = "url('" + imagePath + "')";
  collected.appendChild(small);
}

function updateBoard(){
  if(score > highScore){
    highScore = score;
    localStorage.setItem("highScore", highScore);
  }

  scoreBoard.innerText =
    "Score: " + score +
    " | Life: " + life +
    " | High: " + highScore;
}

function checkGameOver(){
  if(life <= 0){
    gameRunning = false;
    finalText.innerText = "Game Over! Final Score: " + score;
    gameOverScreen.style.display = "flex";
  }
}

function restartGame(){
  score = 0;
  life = 3;
  speed = 4;
  gameRunning = true;
  collected.innerHTML = "";
  gameOverScreen.style.display = "none";
  updateBoard();
}

setInterval(createItem, 900);

</script>

</body>
</html>
