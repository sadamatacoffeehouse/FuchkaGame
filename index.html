<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fuchka Master</title>
<style>
body{
  margin:0;
  overflow:hidden;
  background:#ffe9c6;
  font-family:sans-serif;
}

#scoreBoard{
  position:absolute;
  top:10px;
  left:10px;
  font-size:18px;
  font-weight:bold;
}

#plate{
  width:110px;
  height:20px;
  background:#5c2e00;
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  border-radius:10px;
}

.item{
  width:30px;
  height:30px;
  border-radius:50%;
  position:absolute;
  top:0;
}

.normal{ background:goldenrod; }
.spicy{ background:red; }
.bomb{ background:black; }

#gameOver{
  position:absolute;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.8);
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  font-size:24px;
  display:none;
}

button{
  padding:10px 20px;
  font-size:18px;
  margin-top:15px;
}
</style>
</head>
<body>

<div id="scoreBoard">Score: 0 | Life: 3 | High: 0</div>
<div id="plate"></div>

<div id="gameOver">
  <div id="finalText"></div>
  <button onclick="restartGame()">Restart</button>
</div>

<script>
let plate = document.getElementById("plate");
let scoreBoard = document.getElementById("scoreBoard");
let gameOverScreen = document.getElementById("gameOver");
let finalText = document.getElementById("finalText");

let score = 0;
let life = 3;
let highScore = localStorage.getItem("highScore") || 0;
let speed = 4;
let gameRunning = true;

updateBoard();

document.addEventListener("mousemove", movePlate);
document.addEventListener("touchmove", function(e){
  movePlate(e.touches[0]);
});

function movePlate(e){
  plate.style.left = e.clientX - 55 + "px";
}

function createItem(){
  if(!gameRunning) return;

  let item = document.createElement("div");
  item.classList.add("item");

  let rand = Math.random();

  if(rand < 0.7){
    item.classList.add("normal");
    item.dataset.type = "normal";
  }else if(rand < 0.9){
    item.classList.add("spicy");
    item.dataset.type = "spicy";
  }else{
    item.classList.add("bomb");
    item.dataset.type = "bomb";
  }

  item.style.left = Math.random() * (window.innerWidth - 30) + "px";
  document.body.appendChild(item);

  let fall = setInterval(function(){

    if(!gameRunning){
      clearInterval(fall);
      return;
    }

    item.style.top = item.offsetTop + speed + "px";

    // Missed
    if(item.offsetTop > window.innerHeight){
      if(item.dataset.type !== "bomb"){
        life--;
      }
      item.remove();
      clearInterval(fall);
      checkGameOver();
      updateBoard();
    }

    // Catch
    if(
      item.offsetTop > window.innerHeight - 70 &&
      item.offsetLeft > plate.offsetLeft &&
      item.offsetLeft < plate.offsetLeft + 110
    ){

      if(item.dataset.type === "normal"){
        score += 1;
      }
      else if(item.dataset.type === "spicy"){
        score += 3;
        speed += 0.5; // speed increase
      }
      else if(item.dataset.type === "bomb"){
        life = 0;
      }

      item.remove();
      clearInterval(fall);
      updateBoard();
      checkGameOver();
    }

  }, 20);
}

function updateBoard(){
  if(score > highScore){
    highScore = score;
    localStorage.setItem("highScore", highScore);
  }
  scoreBoard.innerText =
    "Score: " + score +
    " | Life: " + life +
    " | High: " + highScore;
}

function checkGameOver(){
  if(life <= 0){
    gameRunning = false;
    finalText.innerText = "Game Over! Final Score: " + score;
    gameOverScreen.style.display = "flex";
  }
}

function restartGame(){
  score = 0;
  life = 3;
  speed = 4;
  gameRunning = true;
  gameOverScreen.style.display = "none";
  updateBoard();
}

setInterval(createItem, 900);
</script>

</body>
</html>
